### 4장 데이터 중심 접근법 문제점 - 이전 내용

- 행동보다 데이터를 먼저 결정
- 협력이라는 문맥을 벗어나 객체의 상태에 초점
- 캡슐화 위반하기 쉽다.
- 요소간의 결합도가 높아진다.
- 코드를 변경하기 여려워진다.

### 책임 할당하기 - preview

- 어떤 "객체"에게 어떤 "책임을 할당"할지 결정하는 과정.
- 트레이드 오프 활동이기에, 다양한 관점에서 설계할 수 있어야한다.
- 이 책에서는 GRASP 패턴을 통해 책임 할당 과정에 도움을 줄 것 이다.
- GRASP을 배우면?? 응집도, 결합도, 캡슐화 … 등 “기준”에 따라 “책임”을 할당하는데 도움을 받을 수 있다.

### 5장에서 말하고자 하는 내용들

- 올바른 도메인 모델은 존재하지 않는다. ( 요구사항은 항상 변한다. )
- GRASP 패턴 (General Responsibility Assignment Sofrware Parrtern)
  (일반적인 책임 할당을 위한 소프트웨어 패턴)
    - 정보 전문가에게 책임을 할당하라, (INFORMATION EXPERT PATTERN)
    - 낮은 결합도와 높은 응집도  (낮은 결합도 패턴, 높은 응집도 패턴)
    - 창조자에게 객체 생성 책임을 할당하라. (CREATER 패턴)

### 도메인 개념에서 출발하기

![스크린샷 2021-10-05 오전 12.54.14.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/f838d29a-c8c7-46d2-89a7-6914b75c0da7/스크린샷_2021-10-05_오전_12.54.14.png)

- 설계를 하기 전, 도메인 구조를 그려보는 것은 유용하다.
- 도메인 개념을 책임 할당의 대상으로 사용
- 상영, 예매, 영화, 할인조건 과 같이 ㅁ 로 표현 된 것이 "도메인 개념"

- 올바른 도메인 모델은 존재하지 않는다.
    - 도메인 개념을 정리하는데 과투자 하지 말자.
- 정보 전문가에게 책임을 할당하라, INFORMATION EXPERT PATTERN
    - 메시지를 **수신할 적합한 객체**는 누구인가?
    - 수신할 객체는 스스로 상태를 처리 할 수 있는 자율적인 존재여야 한다.
      "책임을 수행하는데 필요한 정보를 가지고 있는 객체에게 할당하라"
      정보를 가지고 있어야만, 스스로 결정 할 수 있다. ⇒ 이러한 객체가 "정보 전문가" 이다.
    - 수신자 결정하는 과정
- 낮은 결합도 패턴
- 높은 응집도 패턴

![스크린샷 2021-10-05 오후 10.48.34.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/70c0add1-128d-42c8-a428-4e7c82e7f4e9/스크린샷_2021-10-05_오후_10.48.34.png)

![스크린샷 2021-10-05 오후 10.46.14.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/5a35db8b-de94-4b49-aec6-ca5fd097af18/스크린샷_2021-10-05_오후_10.46.14.png)

- 사용자에게 제공해야할 기능에 대해서 먼저 생각. ( 영화를 예매하는 "기능"을 제공 )
- 사용자에게 제공 할 기능 == 어플리케이션의 책임 ( 영화를 예매할 "책임"이 있다. )
- 책임을 수행하는 메시지 결정할때는, 수신자가 아니라 **전송자**의 의도를 담아야함.
- **전송자**의 의도 == 메시지 ( 예매하는 것 )
- (메시지 이름을  "예매하라" 로 결정 )
- 메시지를 **수신할 적합한 객체(책임질 객체)**는 누구인가? ( 여기서 정보 전문가 패턴 적용 )
- 수신할 객체는 스스로 상태를 처리 할 수 있는 자율적인 존재여야 한다.
  "책임을 수행하는데 필요한 정보를 가지고 있는 객체에게 할당하라"
  정보를 가지고 있어야만, 스스로 결정 할 수 있다.
- (Screening 상영 도메인 개념을 수신자로 결정)

![스크린샷 2021-10-05 오후 10.46.31.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/050c3c8b-312e-4392-af34-1ab65a051249/스크린샷_2021-10-05_오후_10.46.31.png)

도메인 개념으로 부터 예매 → 가격에 대해서 생각

![스크린샷 2021-10-05 오후 10.46.49.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/b0a97f92-55da-4dbb-9bb8-15261bec31c7/스크린샷_2021-10-05_오후_10.46.49.png)

- 스스로 처리 할 수 없는 작업은 외부에 도움을 요청.
- 책임을 수행하는 메시지 결정할때는, 수신자가 아니라 **전송자**의 의도를 담아야함.
- **전송자**의 의도 == 메시지
- 메시지 이름 결정 (가격을 계산하라)
- 메시지를 **수신할 적합한 객체(책임질 객체)**는 누구인가? ( 여기서 정보 전문가 패턴 적용 )
- 수신할 객체는 스스로 상태를 처리 할 수 있는 자율적인 존재여야 한다.
  "책임을 수행하는데 필요한 정보를 가지고 있는 객체에게 할당하라"
  정보를 가지고 있어야만, 스스로 결정 할 수 있다.
- (Movie 영화 도메인 개념을 수신자로 결정)

![스크린샷 2021-10-05 오후 10.47.02.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/80d0d767-ccee-467e-829e-ed67a458d59d/스크린샷_2021-10-05_오후_10.47.02.png)

도메인 개념으로 부터 가격 → 할인에 대해서 생각

![스크린샷 2021-10-05 오후 10.47.19.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/284d17aa-70c4-430b-8aba-94d99799f6a6/스크린샷_2021-10-05_오후_10.47.19.png)

- 스스로 처리 할 수 없는 작업은 외부에 도움을 요청.
- 책임을 수행하는 메시지 결정할때는, 수신자가 아니라 **전송자**의 의도를 담아야함.
- **전송자**의 의도 == 메시지
- 메시지 이름 결정 (할인 여부를 판단하라)
- 메시지를 **수신할 적합한 객체(책임질 객체)**는 누구인가? ( 여기서 정보 전문가 패턴 적용 )
- 수신할 객체는 스스로 상태를 처리 할 수 있는 자율적인 존재여야 한다.
  "책임을 수행하는데 필요한 정보를 가지고 있는 객체에게 할당하라"
  정보를 가지고 있어야만, 스스로 결정 할 수 있다.
- (discount condition 할인 조건 도메인 개념을 수신자로 결정)

![스크린샷 2021-10-05 오후 11.12.25.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/42fe0721-e14c-4124-99a8-9141b4b17cb2/스크린샷_2021-10-05_오후_11.12.25.png)

위 두가지 상황 중 어떤 것이 더 좋은 설계인가?

- 낮은 결합도 관점 :
- 높은 응집도 관점 :

- 창조자에게 객체 생성 책임을 할당하라. CREATER 패턴

  ![스크린샷 2021-10-06 오전 1.10.10.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/18e88c83-d03a-4571-976e-6e8434fa7c88/스크린샷_2021-10-06_오전_1.10.10.png)

### 구현을 통해 검증

before

![스크린샷 2021-10-05 오후 11.30.58.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/cffd8a39-ca5a-4ed1-ac8a-9c35cdd47d57/스크린샷_2021-10-05_오후_11.30.58.png)

after ( 추상화 )

![스크린샷 2021-10-05 오후 11.31.29.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/cf2ca631-4b53-444e-9fc2-e161beee8859/스크린샷_2021-10-05_오후_11.31.29.png)

![스크린샷 2021-10-05 오후 11.32.01.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/72223227-30da-4302-9e8d-0021f664cdf3/스크린샷_2021-10-05_오후_11.32.01.png)

![스크린샷 2021-10-05 오후 11.32.10.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/8855cabe-6496-4b46-b337-5fbd059d7a81/스크린샷_2021-10-05_오후_11.32.10.png)

2

before

![스크린샷 2021-10-05 오후 11.33.36.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/5d1ef387-f96e-4056-a7ce-70679a11e414/스크린샷_2021-10-05_오후_11.33.36.png)

after (리펙토링)

![스크린샷 2021-10-06 오전 1.39.03.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/df857a5d-d3fb-411e-984e-6f98879bc6fa/스크린샷_2021-10-06_오전_1.39.03.png)

so, 검증 결과??는

GSASP 패턴 과 같은 이론적인 과정을 통해서 구현을 했더니, after 같이 좋은 결과가 나왔더라. 가 아니라

before(일단은 막 구현한 후) 추상화, 리펙토링 했더니 after가 나오고 그게, 이론으로 생각했던 것과 비슷하더라. 라고 말하고 있습니다.

글쓴이 주장 : A(책임주도설계) ⇒ good

우리가 아는 사실 : B(리펙토링,추상화) ⇒ good

![스크린샷 2021-10-05 오후 11.40.55.png](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/c9c31ee9-8cb4-45e9-af0b-c33e4191d37a/스크린샷_2021-10-05_오후_11.40.55.png)